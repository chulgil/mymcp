# Excel MCP 도구

MCP (Model Context Protocol)를 통해 Excel 파일을 조작하고 분석할 수 있는 도구들입니다.

## 엑셀 도구 기능

### 기본 기능
- **Excel 파일 읽기/쓰기**: 다양한 형식의 Excel 파일을 읽고 쓸 수 있습니다
- **차트 생성 및 수정**: 다양한 유형의 차트를 자동으로 생성하고 수정할 수 있습니다
- **피벗 테이블 생성**: 데이터를 분석하고 요약하는 피벗 테이블을 생성할 수 있습니다
- **수식 자동 생성**: 일반적인 Excel 수식들을 자동으로 생성할 수 있습니다
- **데이터 분석 및 처리**: 데이터 정리, 필터링, 정렬 등의 작업을 수행할 수 있습니다

### 고급 기능
- **데이터 검증**: 입력 데이터의 유효성을 검증할 수 있습니다
- **조건부 서식**: 특정 조건에 따라 셀 서식을 자동으로 적용할 수 있습니다
- **매크로 지원**: VBA 매크로를 실행하고 관리할 수 있습니다
- **워크시트 관리**: 여러 워크시트를 효율적으로 관리할 수 있습니다

## 활용 레시피

### 1. 데이터 생성

MCP를 통해 Excel에 샘플 데이터를 자동으로 생성할 수 있습니다.

```python
# MCP를 통해 Excel에 샘플 데이터 생성
# 엑셀 도구를 사용하여 테스트 데이터를 자동으로 생성

# 예시: 판매 데이터 생성
# - 제품명, 수량, 가격, 날짜 등의 컬럼
# - 다양한 제품과 판매량 데이터
# - 날짜 범위 내의 판매 기록
```

**사용 방법:**
1. MCP 엑셀 도구를 활성화합니다
2. "데이터 생성" 명령을 실행합니다
3. 생성할 데이터의 유형과 크기를 지정합니다
4. Excel 파일에 자동으로 데이터가 생성됩니다

### 2. BMI 수식 자동 생성

키와 몸무게 데이터에 BMI 수식을 자동으로 적용할 수 있습니다.

```python
# 키와 몸무게 데이터에 BMI 수식을 자동으로 적용
# =B2/(A2/100)^2 형태의 수식을 자동 생성

# BMI 계산 공식: BMI = 체중(kg) / (키(m))²
# Excel 수식: =B2/(A2/100)^2
# (키가 cm 단위로 입력된 경우)
```

**사용 방법:**
1. 키와 몸무게 데이터가 있는 Excel 파일을 엽니다
2. MCP 엑셀 도구에서 "BMI 수식 생성" 명령을 실행합니다
3. 데이터 범위를 선택합니다
4. BMI 수식이 자동으로 모든 행에 적용됩니다

### 3. 발주년월 수식 자동 생성

날짜 데이터에서 발주년월을 추출하는 수식을 자동으로 생성할 수 있습니다.

```python
# 날짜 데이터에서 발주년월을 추출하는 수식 자동 생성
# =TEXT(A2,"yyyy-mm") 형태의 수식을 자동 생성

# 발주년월 추출 공식: =TEXT(날짜셀, "yyyy-mm")
# 예시: 2024-01-15 → 2024-01
```

**사용 방법:**
1. 날짜 데이터가 있는 Excel 파일을 엽니다
2. MCP 엑셀 도구에서 "발주년월 수식 생성" 명령을 실행합니다
3. 날짜 데이터 범위를 선택합니다
4. 발주년월 형식의 수식이 자동으로 생성됩니다

### 4. 피벗 테이블 자동 생성

데이터 범위를 자동으로 감지하여 피벗 테이블을 생성할 수 있습니다.

```python
# 데이터 범위를 자동으로 감지하여 피벗 테이블 생성
# 행/열/값 필드를 자동으로 설정

# 피벗 테이블 구성:
# - 행: 제품 카테고리
# - 열: 월별 구분
# - 값: 판매량 합계, 매출 합계
```

**사용 방법:**
1. 분석할 데이터가 있는 Excel 파일을 엽니다
2. MCP 엑셀 도구에서 "피벗 테이블 생성" 명령을 실행합니다
3. 데이터 범위를 선택합니다
4. MCP가 데이터 구조를 분석하여 최적의 피벗 테이블을 자동 생성합니다

### 5. VLOOKUP 자동 생성

참조 테이블과 조회 값을 자동으로 감지하여 VLOOKUP 수식을 생성할 수 있습니다.

```python
# 참조 테이블과 조회 값을 자동으로 감지하여 vlookup 수식 생성
# =VLOOKUP(lookup_value, table_array, col_index_num, FALSE)

# VLOOKUP 구성:
# - lookup_value: 조회할 값 (예: 제품 코드)
# - table_array: 참조할 테이블 범위
# - col_index_num: 반환할 열 번호
# - FALSE: 정확한 일치만 허용
```

**사용 방법:**
1. 메인 데이터와 참조 테이블이 있는 Excel 파일을 엽니다
2. MCP 엑셀 도구에서 "VLOOKUP 수식 생성" 명령을 실행합니다
3. 조회할 값과 참조 테이블 범위를 선택합니다
4. VLOOKUP 수식이 자동으로 생성되어 모든 행에 적용됩니다

## 고급 활용 사례

### 데이터 정리 및 변환
- 불규칙한 데이터 형식을 표준 형식으로 변환
- 중복 데이터 제거 및 통합
- 데이터 타입 변환 (텍스트 → 숫자, 날짜 등)

### 보고서 자동 생성
- 월간/분기별 판매 보고서 자동 생성
- 차트와 피벗 테이블이 포함된 대시보드 생성
- 데이터 요약 및 통계 정보 자동 계산

### 데이터 검증 및 품질 관리
- 입력 데이터의 유효성 검증
- 오류 데이터 자동 감지 및 표시
- 데이터 무결성 검사 및 보고

## 문제 해결

### 일반적인 문제들

1. **파일 읽기 오류**
   - 파일 경로가 올바른지 확인하세요
   - 파일이 다른 프로그램에서 열려있지 않은지 확인하세요
   - 파일 권한을 확인하세요

2. **수식 생성 오류**
   - 데이터 형식이 올바른지 확인하세요
   - 참조 범위가 올바른지 확인하세요
   - Excel 버전 호환성을 확인하세요

3. **성능 문제**
   - 대용량 파일의 경우 데이터 범위를 제한하세요
   - 불필요한 계산을 비활성화하세요
   - 메모리 사용량을 모니터링하세요

## 참고 자료

- [Excel 공식 문서](https://support.microsoft.com/ko-kr/excel)
- [MCP 공식 문서](https://modelcontextprotocol.io/)
- [PyHub MCP Tools](https://mcp.pyhub.kr/)
